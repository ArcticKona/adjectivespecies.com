---
layout: post
title: Recent Spam Links
date: 2014-06-03 10:40:13.000000000 -07:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Meta
tags: []
meta:
  _edit_last: '1'
  _social_broadcast_content: 'a:1:{s:7:"twitter";a:1:{i:403645425;s:76:"New Post by
    Makyo: Recent Spam Links http://www.adjectivespecies.com/?p=1826";}}'
  _social_aggregation_next_run: '1401814777'
  _social_notify: '1'
  _social_broadcast_meta: a:1:{s:7:"twitter";a:1:{i:403645425;a:0:{}}}
  _social_broadcasted_ids: 'a:1:{s:7:"twitter";a:1:{i:403645425;a:1:{i:473866796756238336;a:3:{s:7:"message";s:3164:"eyJjcmVhdGVkX2F0IjoiVHVlIEp1biAwMyAxNjo0MDoyMyArMDAwMCAyMDE0IiwiaWQiOiI0NzM4NjY3OTY3NTYyMzgzMzYiLCJpZF9zdHIiOiI0NzM4NjY3OTY3NTYyMzgzMzYiLCJ0ZXh0IjoiTmV3IFBvc3QgYnkgTWFreW86IFJlY2VudCBTcGFtIExpbmtzIGh0dHA6XC9cL3QuY29cLzJYbGNEQWtFbjAiLCJzb3VyY2UiOiI8YSBocmVmPVwiaHR0cHM6XC9cL3NvcHJlc3RvLm1haWxjaGltcC5jb21cIiByZWw9XCJub2ZvbGxvd1wiPlNvY2lhbCBQcm94eSBieSBNYWlsY2hpbXA8XC9hPiIsInRydW5jYXRlZCI6ZmFsc2UsImluX3JlcGx5X3RvX3N0YXR1c19pZCI6bnVsbCwiaW5fcmVwbHlfdG9fc3RhdHVzX2lkX3N0ciI6bnVsbCwiaW5fcmVwbHlfdG9fdXNlcl9pZCI6bnVsbCwiaW5fcmVwbHlfdG9fdXNlcl9pZF9zdHIiOm51bGwsImluX3JlcGx5X3RvX3NjcmVlbl9uYW1lIjpudWxsLCJ1c2VyIjp7ImlkIjoiNDAzNjQ1NDI1IiwiaWRfc3RyIjoiNDAzNjQ1NDI1IiwibmFtZSI6IlthZGplY3RpdmVdW3NwZWNpZXNdIiwic2NyZWVuX25hbWUiOiJhZGpzcGVjaWVzIiwibG9jYXRpb24iOiIiLCJkZXNjcmlwdGlvbiI6IkV4cGxvcmluZyB0aGUgZnVycnkgd29ybGQgZnJvbSB0aGUgaW5zaWRlIG91dC4iLCJ1cmwiOiJodHRwOlwvXC90LmNvXC9aWWg5V21MVTBuIiwiZW50aXRpZXMiOnsidXJsIjp7InVybHMiOlt7InVybCI6Imh0dHA6XC9cL3QuY29cL1pZaDlXbUxVMG4iLCJleHBhbmRlZF91cmwiOiJodHRwOlwvXC9hZGplY3RpdmVzcGVjaWVzLmNvbSIsImRpc3BsYXlfdXJsIjoiYWRqZWN0aXZlc3BlY2llcy5jb20iLCJpbmRpY2VzIjpbMCwyMl19XX0sImRlc2NyaXB0aW9uIjp7InVybHMiOltdfX0sInByb3RlY3RlZCI6ZmFsc2UsImZvbGxvd2Vyc19jb3VudCI6OTQzLCJmcmllbmRzX2NvdW50IjozNDAsImxpc3RlZF9jb3VudCI6MjEsImNyZWF0ZWRfYXQiOiJXZWQgTm92IDAyIDE5OjU3OjM4ICswMDAwIDIwMTEiLCJmYXZvdXJpdGVzX2NvdW50IjoxMzAsInV0Y19vZmZzZXQiOi0yNTIwMCwidGltZV96b25lIjoiUGFjaWZpYyBUaW1lIChVUyAmIENhbmFkYSkiLCJnZW9fZW5hYmxlZCI6ZmFsc2UsInZlcmlmaWVkIjpmYWxzZSwic3RhdHVzZXNfY291bnQiOjI0MDQsImxhbmciOiJlbiIsImNvbnRyaWJ1dG9yc19lbmFibGVkIjpmYWxzZSwiaXNfdHJhbnNsYXRvciI6ZmFsc2UsImlzX3RyYW5zbGF0aW9uX2VuYWJsZWQiOmZhbHNlLCJwcm9maWxlX2JhY2tncm91bmRfY29sb3IiOiJDMERFRUQiLCJwcm9maWxlX2JhY2tncm91bmRfaW1hZ2VfdXJsIjoiaHR0cDpcL1wvYWJzLnR3aW1nLmNvbVwvaW1hZ2VzXC90aGVtZXNcL3RoZW1lMVwvYmcucG5nIiwicHJvZmlsZV9iYWNrZ3JvdW5kX2ltYWdlX3VybF9odHRwcyI6Imh0dHBzOlwvXC9hYnMudHdpbWcuY29tXC9pbWFnZXNcL3RoZW1lc1wvdGhlbWUxXC9iZy5wbmciLCJwcm9maWxlX2JhY2tncm91bmRfdGlsZSI6ZmFsc2UsInByb2ZpbGVfaW1hZ2VfdXJsIjoiaHR0cDpcL1wvcGJzLnR3aW1nLmNvbVwvcHJvZmlsZV9pbWFnZXNcLzQxNjMzMTQwNjIxMDM4Mzg3MlwvRzJYWEc5Y3pfbm9ybWFsLnBuZyIsInByb2ZpbGVfaW1hZ2VfdXJsX2h0dHBzIjoiaHR0cHM6XC9cL3Bicy50d2ltZy5jb21cL3Byb2ZpbGVfaW1hZ2VzXC80MTYzMzE0MDYyMTAzODM4NzJcL0cyWFhHOWN6X25vcm1hbC5wbmciLCJwcm9maWxlX2xpbmtfY29sb3IiOiIwMDg0QjQiLCJwcm9maWxlX3NpZGViYXJfYm9yZGVyX2NvbG9yIjoiQzBERUVEIiwicHJvZmlsZV9zaWRlYmFyX2ZpbGxfY29sb3IiOiJEREVFRjYiLCJwcm9maWxlX3RleHRfY29sb3IiOiIzMzMzMzMiLCJwcm9maWxlX3VzZV9iYWNrZ3JvdW5kX2ltYWdlIjp0cnVlLCJkZWZhdWx0X3Byb2ZpbGUiOnRydWUsImRlZmF1bHRfcHJvZmlsZV9pbWFnZSI6ZmFsc2UsImZvbGxvd2luZyI6ZmFsc2UsImZvbGxvd19yZXF1ZXN0X3NlbnQiOmZhbHNlLCJub3RpZmljYXRpb25zIjpmYWxzZX0sImdlbyI6bnVsbCwiY29vcmRpbmF0ZXMiOm51bGwsInBsYWNlIjpudWxsLCJjb250cmlidXRvcnMiOm51bGwsInJldHdlZXRfY291bnQiOjAsImZhdm9yaXRlX2NvdW50IjowLCJlbnRpdGllcyI6eyJoYXNodGFncyI6W10sInN5bWJvbHMiOltdLCJ1cmxzIjpbeyJ1cmwiOiJodHRwOlwvXC90LmNvXC8yWGxjREFrRW4wIiwiZXhwYW5kZWRfdXJsIjoiaHR0cDpcL1wvYWRqZWN0aXZlc3BlY2llcy5jb21cLz9wPTE4MjYiLCJkaXNwbGF5X3VybCI6ImFkamVjdGl2ZXNwZWNpZXMuY29tXC8/cD0xODI2IiwiaW5kaWNlcyI6WzM3LDU5XX1dLCJ1c2VyX21lbnRpb25zIjpbXX0sImZhdm9yaXRlZCI6ZmFsc2UsInJldHdlZXRlZCI6ZmFsc2UsInBvc3NpYmx5X3NlbnNpdGl2ZSI6ZmFsc2UsImxhbmciOiJldCJ9";s:4:"urls";a:2:{i:0;s:61:"http://www.adjectivespecies.com/2014/06/03/recent-spam-links/";i:1;s:39:"http://www.adjectivespecies.com/?p=1826";}s:7:"account";O:8:"stdClass":1:{s:4:"user";O:8:"stdClass":38:{s:2:"id";s:9:"403645425";s:6:"id_str";s:9:"403645425";s:4:"name";s:20:"[adjective][species]";s:11:"screen_name";s:10:"adjspecies";s:8:"location";s:0:"";s:3:"url";s:27:"http://adjectivespecies.com";s:11:"description";s:46:"Exploring
    the furry world from the inside out.";s:9:"protected";s:1:"0";s:15:"followers_count";s:3:"561";s:13:"friends_count";s:3:"350";s:12:"listed_count";s:1:"6";s:10:"created_at";s:30:"Wed
    Nov 02 19:57:38 +0000 2011";s:16:"favourites_count";s:2:"11";s:10:"utc_offset";s:6:"-28800";s:9:"time_zone";s:30:"Pacific
    Time (US &amp; Canada)";s:11:"geo_enabled";s:1:"0";s:8:"verified";s:1:"0";s:14:"statuses_count";s:4:"1944";s:4:"lang";s:2:"en";s:6:"status";a:10:{s:10:"created_at";s:30:"Sun
    Feb 17 15:21:53 +0000 2013";s:2:"id";s:18:"303162359898312705";s:6:"id_str";s:18:"303162359898312705";s:4:"text";s:49:"New
    Post: Birds of a Feather http://t.co/Y61Z4Ht6";s:6:"source";s:9:"TweetDeck";s:9:"truncated";s:1:"0";s:13:"retweet_count";s:1:"2";s:9:"favorited";s:1:"0";s:9:"retweeted";s:1:"0";s:18:"possibly_sensitive";s:1:"0";}s:20:"contributors_enabled";s:1:"0";s:13:"is_translator";s:1:"0";s:24:"profile_background_color";s:6:"C0DEED";s:28:"profile_background_image_url";s:47:"http://a0.twimg.com/images/themes/theme1/bg.png";s:34:"profile_background_image_url_https";s:49:"https://si0.twimg.com/images/themes/theme1/bg.png";s:23:"profile_background_tile";s:1:"0";s:17:"profile_image_url";s:71:"http://a0.twimg.com/profile_images/1647343758/adjspecies-ico_normal.png";s:23:"profile_image_url_https";s:73:"https://si0.twimg.com/profile_images/1647343758/adjspecies-ico_normal.png";s:18:"profile_link_color";s:6:"0084B4";s:28:"profile_sidebar_border_color";s:6:"C0DEED";s:26:"profile_sidebar_fill_color";s:6:"DDEEF6";s:18:"profile_text_color";s:6:"333333";s:28:"profile_use_background_image";s:1:"1";s:15:"default_profile";s:1:"1";s:21:"default_profile_image";s:1:"0";s:9:"following";s:1:"0";s:19:"follow_request_sent";s:1:"0";s:13:"notifications";s:1:"0";}}}}}}'
author:
  login: makyo
  email: makyo@adjectivespecies.com
  display_name: Makyo
  first_name: Makyo
  last_name: ''
---
<p>[adjective][species] was compromised last night through a template loader bug in WordPress.  The only effect that we have seen from the compromise was that spam links were injected at the top of the page, visible only to users on certain IP ranges (notably Google; the goal being to boost spam sites' popularity in the search engine).  This appears to have been an automated attack on several WordPress sites on our host, and no data has been compromised, however, this should serve as a reminder to practice Safe Password!</p>
<!--more-->
<p>If you run WordPress and find yourself in a similar situation, here are the steps required to clean it up:</p>
<ol>
<li>Search for the exploit in your installation.  It looks like <a href="http://pastebin.com/hkNT5Ew7" target="_blank">this</a> at the top of your template's index.php file.  If you have access to the command line, you can check for it with the following command:<br />
<code>find . -name *.php -exec grep -q "mx_start" {}\; -print</code></li>
<li>Clean the files by removing the block.  If you'd like to automate the process, here is a python snippet for doing so:
<pre>import re
import sys

f = open(sys.argv[1], 'r')
text = f.read()
f.close()

pattern = re.compile(r'&lt;\?php /\*mx_start.*mx_orig_end\*/ \?&gt;', re.MULTILINE|re.DOTALL)
print pattern.sub('', text)
</pre>
<p>Run it automatically by saving it as demx.py, and using bash like so:<br />
<code>for i in `find . -name *.php -exec grep -q "mx_start" {} \; -print`; do python demx.py $i &gt; $i.demx; mv $i.demx $i; done</code></li>
</ol>



